# Mobileye Data Engineering Technical Assessment (Senior Data Engineer)

## Pipeline Design

### Diagram
To view the diagram of the system components and flows, open the file `mobileye.drawio` using [diagrams.net](https://app.diagrams.net/).

## Coding Skills Assessment

### Build Docker Image
To build a Docker image for the Mobileye app, run the following command:
```
docker build -t mobileye .
```

### Run the Application
To run the entire system, including the traffic generator, ClickHouse DB, and Mobileye app, use Docker Compose:
```
docker-compose up
```

### Simulate a Query
You can simulate a query to retrieve the latest status event for each vehicle along with the latest detection objects. Follow these steps:

1. Access the ClickHouse container's command line:
```
docker exec -it clickhouse /bin/bash
```

2. Run the ClickHouse client to execute the query:
```
clickhouse-client
```

3. Paste the following query and press Enter:
```sql
SELECT vs.report_time AS last_report_time, vs.status, vs.vehicle_id, od.detection_time, od.detections 
FROM (SELECT report_time, status, vehicle_id 
      FROM (SELECT report_time, status, vehicle_id, rank() OVER (PARTITION BY vehicle_id ORDER BY report_time DESC) AS time_rank 
            FROM mobileye.vehicles_status) AS sort_vs 
      WHERE sort_vs.time_rank = 1) AS vs 
ASOF LEFT JOIN mobileye.objects_detection od ON vs.vehicle_id = od.vehicle_id AND vs.report_time >= od.detection_time
```

4. To see an example of the query result, refer to the `vehicle_status_and_last_objects_result` file.

### Database Choice
The project utilizes ClickHouse as the database solution. ClickHouse is a columnar database optimized for fast analytics on large-scale data. The choice of ClickHouse enables efficient storage and querying of time-series data, which aligns well with the telemetry and event data generated by the Mobileye app.

### Improvements with More Time
With additional time, the following enhancements could be made to the project:
- Implementing unit tests and integration tests to ensure code correctness and robustness.
- To allow sending database parameters from docker-compose file to the Mobileye app.
- Implementing monitoring and alerting mechanisms to proactively detect and address issues.
- Enhancing the data processing pipeline with fault tolerance and retry mechanisms for task execution.
- Splite mobileye application into few appliactions:
    1. Extractor - for read the events.
    2. Ingest system to move the data into the loader application
    3. Loader application to recive the data and load it into the DB.
